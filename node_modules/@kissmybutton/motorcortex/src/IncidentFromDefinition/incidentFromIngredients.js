import { getAnId } from '../_coreUtils/Helper';

/**
 * @param {object} ingredients -
 * {
 *      id
 *      attrs
 *      props
 *      Incident
 *      plugin_npm_name
 *      Channel
 *      context (optional)
 *      mcid (optional)
 *      dnaExtras
 * }
 * */
export default function incidentFromIngredients(ingredients) {
  if (!Object.prototype.hasOwnProperty.call(ingredients, 'dnaExtras')) {
    ingredients.dnaExtras = {};
  }
  const incident = new ingredients.Incident(
    ingredients.attrs,
    { ...ingredients.props, id: ingredients.id || getAnId() },
    {
      ...ingredients.dnaExtras,
      context: ingredients.context,
      mcid: ingredients.mcid,
    }
  );
  incident.mc_plugin_npm_name = ingredients.plugin_npm_name;
  incident.plugin_channel_class = ingredients.Channel;
  incident.DescriptiveIncident = ingredients.DescriptiveIncident;
  return incident;
}
