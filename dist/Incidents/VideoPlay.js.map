{"version":3,"sources":["../../src/Incidents/VideoPlay.js"],"names":["MC","require","_webdsp","webdsp","loadWASM","then","module","VideoPlay","API","MediaPlayback","play","millisecond","startFrom","Object","prototype","hasOwnProperty","call","props","video","element","entity","ctx","currentTime","drawFrame","drawImage","timeout","setTimeout","stop","pause","clearTimeout","onProgress","f","exports"],"mappings":"AAAA,MAAMA,KAAKC,QAAQ,2BAAR,CAAX;AACA,MAAMC,UAAUD,QAAQ,SAAR,CAAhB;AACA,IAAIE,SAAS,EAAb;AACAD,QAAQE,QAAR,GAAmBC,IAAnB,CAAwBC,UAAU;AAC9BH,aAASG,MAAT;AACA;AACH,CAHD;;AAKA,MAAMC,SAAN,SAAwBP,GAAGQ,GAAH,CAAOC,aAA/B,CAA6C;AACzCC,SAAKC,WAAL,EAAkB;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAIC,YAAY,CAAhB;AACA,YAAIC,OAAOC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKC,KAA1C,EAAiD,WAAjD,CAAJ,EAAmE;AAC/DL,wBAAY,KAAKK,KAAL,CAAWL,SAAvB;AACH;;AAED,cAAMM,QAAQ,KAAKC,OAAL,CAAaC,MAAb,CAAoBF,KAAlC;AACA,cAAMG,MAAM,KAAKF,OAAL,CAAaC,MAAb,CAAoBC,GAAhC;;AAEAH,cAAMI,WAAN,GAAoB,CAACV,YAAYD,WAAb,IAA4B,IAAhD;AACAO,cAAMR,IAAN;;AAEA,cAAMa,YAAaL,KAAD,IAAW;AACzBG,gBAAIG,SAAJ,CAAcN,KAAd,EAAqB,CAArB,EAAwB,CAAxB;;AAEA,iBAAKO,OAAL,GAAeC,WAAW,YAAW;AACjCH,0BAAUL,KAAV;AACH,aAFc,EAEZ,EAFY,CAAf;AAGH,SAND;AAOAK,kBAAUL,KAAV;;AAEA,eAAO,IAAP;AACH;;AAEDS,WAAO;AACH,aAAKR,OAAL,CAAaC,MAAb,CAAoBF,KAApB,CAA0BU,KAA1B;AACAC,qBAAa,KAAKJ,OAAlB;AACH;;AAEDK,eAAWC,CAAX,EAAcpB,WAAd,EAA2B;AACvB,YAAIC,YAAY,CAAhB;AACA,YAAIC,OAAOC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqC,KAAKC,KAA1C,EAAiD,WAAjD,CAAJ,EAAmE;AAC/DL,wBAAY,KAAKK,KAAL,CAAWL,SAAvB;AACH;AACD,aAAKO,OAAL,CAAaC,MAAb,CAAoBF,KAApB,CAA0BI,WAA1B,GAAwC,CAACV,YAAYD,WAAb,IAA4B,IAApE;AACA,aAAKQ,OAAL,CAAaC,MAAb,CAAoBC,GAApB,CAAwBG,SAAxB,CAAkC,KAAKL,OAAL,CAAaC,MAAb,CAAoBF,KAAtD,EAA6D,CAA7D,EAAgE,CAAhE;AACH;AA5CwC;;AA+C7CZ,OAAO0B,OAAP,GAAiBzB,SAAjB","file":"VideoPlay.js","sourcesContent":["const MC = require(\"@kissmybutton/motorcortex\");\nconst _webdsp = require(\"web-dsp\");\nvar webdsp = {};\n_webdsp.loadWASM().then(module => {\n    webdsp = module;\n    // things to execute on page load only after module is loaded\n});\n\nclass VideoPlay extends MC.API.MediaPlayback {\n    play(millisecond) {\n        // if (this.element.soundLoaded === false) {\n        //     this.setBlock('loading sound');\n        //     this.element.pubSub.sub(this.id, () => {\n        //         this.unblock();\n        //     });\n        //     return false;\n        // }\n        let startFrom = 0;\n        if (Object.prototype.hasOwnProperty.call(this.props, 'startFrom')) {\n            startFrom = this.props.startFrom;\n        }\n\n        const video = this.element.entity.video;\n        const ctx = this.element.entity.ctx;\n\n        video.currentTime = (startFrom + millisecond) / 1000;\n        video.play();\n\n        const drawFrame = (video) => {\n            ctx.drawImage(video, 0, 0);\n\n            this.timeout = setTimeout(function() {\n                drawFrame(video);\n            }, 10);\n        }\n        drawFrame(video);\n\n        return true;\n    }\n\n    stop() {\n        this.element.entity.video.pause();\n        clearTimeout(this.timeout);\n    }\n\n    onProgress(f, millisecond) {\n        let startFrom = 0;\n        if (Object.prototype.hasOwnProperty.call(this.props, 'startFrom')) {\n            startFrom = this.props.startFrom;\n        }\n        this.element.entity.video.currentTime = (startFrom + millisecond) / 1000;\n        this.element.entity.ctx.drawImage(this.element.entity.video, 0, 0);\n    }\n}\n\nmodule.exports = VideoPlay;\n"]}